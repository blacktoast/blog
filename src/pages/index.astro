---
import Header from '@/components/Header.astro';
import Footer from '@/components/Footer.astro';
import Layout from '@/layouts/Layout.astro';

---
<Layout>
	<Header />
		<main class="mt-4"> 

			<h1 class="text-4xl max-sm:px-4 font-bold font-HomeHello mb-12">hyggelig!</h1>
			<div class="flex items-center blog-name-container">
				This is <span id="blog-title-text" class="ml-2 text-lg px-2 inline-flex items-center gap-1 transition-all duration-500 ease-in-out special-font relative overflow-hidden" >
					<span class="title-text text-xl text-transparent bg-clip-text">Retto's Blog</span>
					<span class="title-flag text-xl"/>
				</span>
			</div>
		</main>
		<Footer />
</Layout>

<style>	

.blog-name-container{
}
	.font-HomeHello {
		font-family: 'HomeHello', sans-serif;
	}

	.special-font[data-lang="en"] {
		font-family: 'en-blog', sans-serif;
		font-weight: 700;
	}

	.special-font[data-lang="no"] {
		font-family: 'FRLogo', sans-serif;
	}

	.special-font[data-lang="ja"] {
		font-family: 'JPLogo', sans-serif !important;
		font-weight: 900!;
	}
	
	.special-font[data-lang="zh"] {
		font-family: 'JPLogo', sans-serif;
		font-weight: normal;
	}
	
	.special-font[data-lang="fr"] {
		font-family: 'FRLogo', sans-serif;
	}
	
	#blog-title-text {
		display: inline-flex;
		align-items: center;
		gap: 0.2rem;
		padding-inline: 0.4rem;
		letter-spacing: -0.02em;
	}

	#blog-title-text .title-text {
		background-image:
		radial-gradient(circle at 6% 25%, rgba(15, 23, 42, 0.85), transparent 45%),
		radial-gradient(circle at 90% 5%, rgba(30, 64, 175, 0.65), transparent 40%),
		conic-gradient(from 140deg at 50% 50%, #0f172a, #1e1b4b, #312e81, #4c1d95, #5b21b6, #7c3aed, #c026d3, #f97316, #fde047, #0f172a);
		background-size: 180% 180%;
		background-position: 50% 100%;
		color: transparent;
		-webkit-text-fill-color: transparent;
		-webkit-background-clip: text;
		background-clip: text;
	}

	#blog-title-text .title-flag {
		color: inherit;
	}

	#blog-title-text::after {
		content: '';
		position: absolute;
		inset: 25% auto auto 12%;
		width: 68%;
		height: 35%;
		border-radius: 9999px;
		filter: blur(18px);
		opacity: 0.8;
		pointer-events: none;
		mix-blend-mode: screen;
	}

	:global(html[data-theme="dark"]) #blog-title-text {
		filter: drop-shadow(0 18px 28px rgba(16, 185, 129, 0.45));
	}

	:global(html[data-theme="dark"]) #blog-title-text .title-text {
		background-image:
		radial-gradient(circle at 5% 18%, rgba(255, 255, 255, 0.7), transparent 48%),
		radial-gradient(circle at 85% 5%, rgba(248, 250, 252, 0.55), transparent 42%),
		conic-gradient(from 210deg at 50% 50%, #ffffff, #f8fafc, #e0f2fe, #d1fae5, #fef3c7, #bacadc);
		background-size: 180% 180%;
		background-position: 100% 59%;
	}
</style>

<script is:inline data-astro-rerun>
	(function() {
		const titles = [
			{ text: "Retto's blog", flag: 'üá∫üá∏', lang: 'en' },    // ÏòÅÏñ¥
			{ text: '„É©„ÉÉ„Ç≥„ÅÆ„Éñ„É≠„Ç∞', flag: 'üáØüáµ', lang: 'ja' },    // ÏùºÎ≥∏Ïñ¥
			{ text: 'Êµ∑Áç∫ÁöÑÂçöÂÆ¢', flag: 'üá®üá≥', lang: 'zh' },      // Ï§ëÍµ≠Ïñ¥
			{ text: 'Le Blog de Loutre', flag: 'üá´üá∑', lang: 'fr' } ,   // ÌîÑÎûëÏä§Ïñ¥
			{ text: "Sj√∏oter's Blog", flag: 'üá≥üá¥', lang: 'no' } ,    // ÎÖ∏Î•¥Ïõ®Ïù¥Ïñ¥
		];
		const INTERVAL_DURATION = 5000; 
		
		if (!window.__siteTitleState) {
			window.__siteTitleState = {
				currentIndex: 0,
				lastUpdateTime: Date.now(),
				intervalId: null
			};
		}
		
		const state = window.__siteTitleState;
		const now = Date.now();
		const timeSinceLastUpdate = now - state.lastUpdateTime;
		
		// Í≤ΩÍ≥ºÌïú ÏãúÍ∞ÑÎßåÌÅº Ïù∏Îç±Ïä§ ÏßÑÌñâ
		if (timeSinceLastUpdate > 0) {
			const intervalsPassed = Math.floor(timeSinceLastUpdate / INTERVAL_DURATION);
			state.currentIndex = (state.currentIndex + intervalsPassed) % titles.length;
		}

		function applyTitle(titleElement, index) {
			const title = titles[index];
			const textSpan = titleElement.querySelector('.title-text');
			const flagSpan = titleElement.querySelector('.title-flag');
			if (textSpan) {
				textSpan.textContent = title.text;
			}
			if (flagSpan) {
				flagSpan.textContent = title.flag;
			}
			titleElement.setAttribute('data-lang', title.lang);
		}

		function initTitleRotation() {
			const titleElement = document.getElementById('blog-title-text');
			if (!titleElement) {
				setTimeout(initTitleRotation, 100);
				return;
			}

			// Í∏∞Ï°¥ Ïù∏ÌÑ∞Î≤å Ï†ïÎ¶¨
			if (state.intervalId) {
				clearInterval(state.intervalId);
			}

			applyTitle(titleElement, state.currentIndex);
			titleElement.style.transform = 'translateY(0)';
			titleElement.style.opacity = '1';

			function rotateTitle() {
				titleElement.style.transform = 'translateY(-100%)';
				titleElement.style.opacity = '0';
				
				setTimeout(() => {
					// Îã§Ïùå ÌÖçÏä§Ìä∏Î°ú Î≥ÄÍ≤Ω
					state.currentIndex = (state.currentIndex + 1) % titles.length;
					state.lastUpdateTime = Date.now();
					applyTitle(titleElement, state.currentIndex);
					
					titleElement.style.transform = 'translateY(100%)';
					titleElement.style.opacity = '0';
					
					requestAnimationFrame(() => {
						requestAnimationFrame(() => {
							titleElement.style.transform = 'translateY(0)';
							titleElement.style.opacity = '1';
						});
					});
				}, 250);
			}

			// Îã§Ïùå Î≥ÄÍ≤ΩÍπåÏßÄ ÎÇ®ÏùÄ ÏãúÍ∞Ñ Í≥ÑÏÇ∞
			const timeUntilNextChange = timeSinceLastUpdate >= INTERVAL_DURATION 
				? INTERVAL_DURATION 
				: INTERVAL_DURATION - (timeSinceLastUpdate % INTERVAL_DURATION);
			
			// ÎÇ®ÏùÄ ÏãúÍ∞Ñ ÌõÑ Ï≤´ Î≥ÄÍ≤Ω, Í∑∏ Îã§ÏùåÎ∂ÄÌÑ∞Îäî Ï†ïÍ∏∞Ï†ÅÏúºÎ°ú Î≥ÄÍ≤Ω
			setTimeout(() => {
				rotateTitle();
				state.intervalId = setInterval(rotateTitle, INTERVAL_DURATION);
			}, timeUntilNextChange);
		}

		// DOMÏù¥ Î°úÎìúÎêú ÌõÑ Ïã§Ìñâ
		if (document.readyState === 'loading') {
			document.addEventListener('DOMContentLoaded', initTitleRotation);
		} else {
			initTitleRotation();
		}
	})();
</script>