---
import { Image } from 'astro:assets';
import type { CollectionEntry } from 'astro:content';
import Footer from '../components/Footer.astro';
import FormattedDate from '../components/FormattedDate.astro';
import Header from '../components/Header.astro';
import BlurTop from '../components/BlurTop.astro';
import Layout from '@/layouts/Layout.astro';
import { Icon } from 'astro-icon/components';
import DynamicProgressBar from '../components/DynamicProgressBar.astro';
import type { MarkdownHeading } from 'astro';

type BlogData = CollectionEntry<'blog'>['data'];
type PebbleData = CollectionEntry<'pebbles'>['data'] & { heroImage?: undefined };
type Props = (BlogData | PebbleData) & { ogImage?: string; headings?: MarkdownHeading[] };

const { title, description, pubDate, updatedDate, heroImage, tags = [], ogImage, headings } = Astro.props as Props;
---

<Layout
	 title={title}
	 description={description}
	 pubDatetime={pubDate}
	 modDatetime={updatedDate ?? null}
	 ogImage={ogImage || (heroImage ? heroImage.src : undefined)}
>
	<DynamicProgressBar title={title} headings={headings ?? []} />
	<Header id="blog-header" />
	<BlurTop />
	<main >
		<article class="app-prose px-2 sm:px-0 mt-0 sm:mt-4">
			<div>
				<div class="title">
					<h1>{title}</h1>
					<div class="date">
						<div class="flex items-center gap-1 text-gray-400">	
							<Icon name="lucide:calendar" class="w-4 h-4 inline-block mr-1" /> 
							<FormattedDate date={pubDate} />
						</div>
						{
							updatedDate && (
								<div class="flex items-center gap-1 text-gray-300">
									Last updated on <FormattedDate date={updatedDate} />
								</div>
							)
						}

					{	
						tags.length > 0 && (
						<div class="flex items-center gap-2 mt-3">
							{
								tags.map((tag) => (
									<span class="flex items-center gap-1 bg-muted/10 px-2 py-0.5 rounded text-xs font-medium text-muted-foreground">
										<Icon name="lucide:hash" class="w-3 h-3" />
										{tag}
									</span>
								))
							}
						</div>
					)
				}

					</div>
					<hr />
				</div>
				<slot />
			</div>
		</article>
	</main>
	<Footer />
</Layout>

<style>
		.hero-image {
		width: 100%;
	}

 article {
		display: flex;
		flex-direction: column;
		gap: 2rem;
	}
</style>
