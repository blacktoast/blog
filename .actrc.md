# Act Configuration for Local GitHub Actions Testing

## 설치
```bash
# macOS
brew install act

# Linux
curl https://raw.githubusercontent.com/nektos/act/master/install.sh | sudo bash

# Windows (WSL)
# WSL에서 Linux 명령어 사용
```

## 사용법

### 전체 워크플로우 실행
```bash
# 모든 워크플로우 실행
act

# 특정 워크플로우만 실행
act -W .github/workflows/deploy-frontend.yml
act -W .github/workflows/deploy-backend.yml

# 테스트 워크플로우 실행
act -W .github/workflows/test.yml
```

### 특정 잡(Job) 실행
```bash
# 프론트엔드 배포 잡만 실행
act -j deploy -W .github/workflows/deploy-frontend.yml

# 백엔드 배포 잡만 실행
act -j deploy -W .github/workflows/deploy-backend.yml
```

### 환경 변수 설정
```bash
# Cloudflare 자격 증명 (실제 배포 시에만)
export CLOUDFLARE_API_TOKEN="your-api-token"
export CLOUDFLARE_ACCOUNT_ID="your-account-id"

# act 실행 시 환경 변수 전달
act --secret CLOUDFLARE_API_TOKEN=$CLOUDFLARE_API_TOKEN \
    --secret CLOUDFLARE_ACCOUNT_ID=$CLOUDFLARE_ACCOUNT_ID
```

## 테스트 시나리오

### 1. 프론트엔드 변경 테스트
```bash
# 가상의 프론트엔드 파일 변경
touch apps/frontend/test-change.txt

# 프론트엔드 워크플로우 실행
act -W .github/workflows/deploy-frontend.yml

# 정리
rm apps/frontend/test-change.txt
```

### 2. 백엔드 변경 테스트
```bash
# 가상의 백엔드 파일 변경
touch apps/backend/test-change.txt

# 백엔드 워크플로우 실행
act -W .github/workflows/deploy-backend.yml

# 정리
rm apps/backend/test-change.txt
```

### 3. 공통 변경 테스트
```bash
# 루트 파일 변경
touch package.json.new
mv package.json.new package.json

# 두 워크플로우 모두 실행
act -W .github/workflows/deploy-frontend.yml
act -W .github/workflows/deploy-backend.yml
```

## 유용한 옵션

### 상세 출력
```bash
act --verbose
act --dry-run  # 실제 실행 없이 시뮬레이션만
```

### 특정 이벤트 시뮬레이션
```bash
# push 이벤트 시뮬레이션
act -e push.json

# pull_request 이벤트 시뮬레이션  
act -e pull_request.json
```

### 캐시 사용
```bash
# Docker 이미지 캐시 사용
act --reuse
```

## 문제 해결

### 권한 오류
```bash
# Docker 권한 문제 해결
sudo usermod -aG docker $USER
newgrp docker
```

### 메모리 부족
```bash
# Docker 메모리 제한 조정
act --container-daemon-socket /var/run/docker.sock
```

### 네트워크 문제
```bash
# 로컬 네트워크 사용
act --bind
```

## 주의사항

1. **실제 배포 주의**: act로 실제 Cloudflare 배포 시 API 토큰이 필요하며 실제 배포가 이루어집니다
2. **로컬 환경**: act는 Docker 기반이므로 Docker가 설치되어 있어야 합니다
3. **시간 소요**: 첫 실행 시 Docker 이미지 다운로드로 시간이 오래 걸릴 수 있습니다
4. **네트워크**: 로컬 환경의 네트워크 제약이 있을 수 있습니다