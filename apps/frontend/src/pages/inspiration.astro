---
import Header from '@/components/Header.astro';
import Footer from '@/components/Footer.astro';
import Layout from '@/layouts/Layout.astro';
import InspirationGrid from '@/components/inspiration/InspirationGrid';
import LightRays from '@/components/inspiration/LightRays';
import LightModeController from '@/components/inspiration/LightModeController';
---

<Layout title="영감" description="영감을 받은 사이트들">
	<Header isInspirationPage={true} />

	<!-- LightRays 배경: 전체 화면 고정 -->
	<div class="light-rays-background">
		<LightRays
			client:visible
			raysOrigin="top-center"
			raysSpeed={0.5}
			lightSpread={0.2}
			rayLength={1}
			pulsating={true}
			fadeDistance={1.2}
			saturation={0.8}
			followMouse={true}
			mouseInfluence={0.15}
			useThemeColor={true}
		/>
	</div>

	<header class="page-header">
		<h2 class="page-title">靈感</h2>
	</header>

	<main class="relative z-10 mt-8">
		<InspirationGrid client:visible />
	</main>

	<!-- 조명 모드 컨트롤러 (오버레이 + 떠있는 전구) -->
	<LightModeController client:load />

	<Footer />
</Layout>

<style>
	/* Chinese font for title */
	@font-face {
		font-family: 'ChineseTitle';
		src: url('/fonts/cn-2.woff2') format('woff2');
		font-weight: 700;
		font-style: normal;
		font-display: swap;
	}

	.light-rays-background {
		position: fixed;
		inset: 0;
		z-index: 6; /* CircularReveal(5) 위, 카드(10) 아래 */
		pointer-events: none;
		overflow: hidden;
		/* 기본 숨김 - 조명 모드 진입 애니메이션 완료 후 표시 */
		opacity: 0;
		transition: opacity 0.3s ease-out;
	}

	/* 조명 모드 진입 완료 후 LightRays 표시 */
	:global(body.light-rays-visible) .light-rays-background {
		opacity: 1;
	}

	/* Page Header - Glass style */
	.page-header {
		position: relative;
		z-index: 10;
		text-align: center;
		padding-top: 1rem;
	}

	.page-title {
		font-family: 'ChineseTitle', serif;
		font-size: 2.5rem;
		font-weight: 400;
		margin-bottom: 0.5rem;
		letter-spacing: 0.1em;

		/* accent 색상 기반 네온 효과 (oklch로 채도 유지) */
		--neon-core: color-mix(in oklch, var(--color-accent), white 25%);
		--neon-glow: var(--color-accent);
		--neon-outer: color-mix(in oklch, var(--color-accent), black 20%);

		color: var(--neon-core);

		/* 초기 상태: 완전히 숨김 (LightRays 점등 전) */
		opacity: 0;
		text-shadow: none;
		filter: saturate(1.4);
	}

	/* LightRays가 켜진 후: flickering → pulse 시퀀스 */
	:global(body.light-rays-visible) .page-title {
		animation:
			neon-flicker-on 0.6s ease-out 0.45s forwards,
			neon-pulse 2s ease-in-out 0.65s infinite alternate;
	}

	/* 네온사인 점등 애니메이션 - 실제 네온처럼 1-2번 깜빡이며 안정화 */
	@keyframes neon-flicker-on {
		/* 꺼진 상태 */
		0% {
			opacity: 0;
			text-shadow: none;
		}
		/* 첫 번째 점등 시도 - 밝게 */
		15% {
			opacity: 1;
			text-shadow:
				0 0 5px var(--neon-core),
				0 0 10px var(--neon-core),
				0 0 20px var(--neon-glow),
				0 0 40px var(--neon-glow),
				0 0 80px var(--neon-outer),
				0 0 120px var(--neon-outer);
		}
		/* 첫 번째 꺼짐 - 희미하게 */
		25% {
			opacity: 0.3;
			text-shadow:
				0 0 2px var(--neon-core),
				0 0 4px var(--neon-core);
		}
		/* 두 번째 점등 */
		40% {
			opacity: 1;
			text-shadow:
				0 0 5px var(--neon-core),
				0 0 10px var(--neon-core),
				0 0 20px var(--neon-glow),
				0 0 40px var(--neon-glow),
				0 0 80px var(--neon-outer),
				0 0 120px var(--neon-outer);
		}
		/* 두 번째 약간 꺼짐 */
		50% {
			opacity: 0.6;
			text-shadow:
				0 0 3px var(--neon-core),
				0 0 6px var(--neon-core),
				0 0 12px var(--neon-glow),
				0 0 24px var(--neon-glow);
		}
		/* 안정화 - 완전 점등 */
		70%, 100% {
			opacity: 1;
			text-shadow:
				0 0 5px var(--neon-core),
				0 0 10px var(--neon-core),
				0 0 20px var(--neon-glow),
				0 0 40px var(--neon-glow),
				0 0 80px var(--neon-outer),
				0 0 120px var(--neon-outer);
		}
	}

	/* 안정화 후 부드러운 pulse */
	@keyframes neon-pulse {
		from {
			filter: saturate(1.4) brightness(1);
			opacity: 1;
		}
		to {
			filter: saturate(1.3) brightness(0.85);
			opacity: 0.9;
		}
	}

	.page-description {
		font-size: 1rem;
		color: rgba(255, 255, 255, 0.5);
		font-weight: 300;
		letter-spacing: 0.02em;
	}

	:global([data-theme="light"]) .page-description {
		color: rgba(255, 107, 107, 0.6);
	}

	:global([data-theme="spring"]) .page-description {
		color: rgba(100, 255, 218, 0.6);
	}


</style>